This is the sourcecode for: http://marcelog.github.com/articles/swig_php_libpcap_module_c++.html

It is a small C++ wrapper around libpcap, that comes with a SWIG interface file 
for PHP. So this will in essence, give you access to libpcap from PHP.

Currently, it can list all devices and sniff packets without using pcap_loop(). It
uses pcap_next().

NOTE: It's very possible that you will need root or administrator privileges
to sniff an interface. So, beware.

USE EXAMPLE
===========

List all devices
----------------
foreach (SimplePcap::findAllDevs() as $name => $description) {
    echo "$name => $description\n";
}

Getting packets
---------------
First, get an instance of the SimplePcap class:
$simplePcap = new SimplePcap($interfaceName, $filter, $snapLen);

$interfaceName can be something like "any", or "eth0".
$filter is a libpcap filter, like "port 80".
$snapLen is the maximum amount of bytes to capture per packet.

Then, loop!
while(true) {
    // Get a packet
    $packet = $simplePcap->get(); // Returns a 'Packet' Object.

    // Get the data
    $data = $packet->getData(); // Returns a string

    // Get the packet information
    $capturedLen = $packet->getCapturedLen();
    $realLen = $packet->getRealLen();
    $timeSeconds = $packet->getSecondsOffset();
    $timeMicroSeconds = $packet->getMicroSecondsOffset();
}

That's it. Happy sniffing!

Compiling
=========
Edit the GNUmakefile. You will need to specify the SWIG binary location and
the php include directory (for the .h files). Then, just:
$ gmake

The "build" directory will be generated, with the SimplePcap.so file. Include it in your
php.ini file like:
extension=SimplePcap.so

See the example directory, that ships a sample php.ini file that you can use with the -c flag for php:

$ cd example
$ php -c php.ini list.php


